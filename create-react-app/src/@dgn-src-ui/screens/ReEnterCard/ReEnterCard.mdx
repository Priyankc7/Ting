import { Story, Meta, Props, Preview } from "@storybook/addon-docs/blocks";
import ReEnterCard from "./ReEnterCard";
import PassingViewProps from "@dgn-src-ui/docs/partials/PassingViewProps.mdx";
import ViewInheritance from "@dgn-src-ui/docs/partials/ViewInheritance.mdx";
import FormSubmissionHandling from "@dgn-src-ui/docs/partials/FormSubmissionHandling.mdx";

<Meta title="ReEnter Card" component={ReEnterCard} />

# ReEnter Card Screen

This screen is shown when the consumer has entered their card information into the SRC gateway, it is recognized as a Discover card, but one of the fields (card number, expiration date, security code) is incorrect. Rather than bounce them back to the SRCI flow, keep them within the Discover experience by showing this field.

## Usage

```jsx
import View from "@dgn-src-ui/core/View";

// ...

<View
  clearSecurityCodeOnError={true}
  form={{
    onSubmit: (data, e, context) => {
      // Handle submission
    },
    defaultValues: {
      primaryAccountNumber: "4321 8054 2643 9101",
      expirationDate: "01/2022",
    },
  }}
  onCancelClick={(e) => {
    // Navigate back to merchant
    e.preventDefault();
  }}
/>;
```

<PassingViewProps />

## Form Fields

| Field Name           | Rules                                            | Description                                                                                                                                                                                                              |
| -------------------- | ------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| primaryAccountNumber | required,length:16,validLuhn                     | Credit card number                                                                                                                                                                                                       |
| expirationDate       | required,max_length:6\*,format:MM/YYYY,validDate | MM/YYYY expiration date. A valid date constitutes a date in the present or future. \*=allow 6 digits plus "/". Value is split and transformed on submission to also include separated values as "expMonth" and "expYear" |
| cardSecurityCode     | required,length:3                                | Security code on card                                                                                                                                                                                                    |

On successful submission, `expirationDate` is transformed into two fields `panExpirationMonth` and `panExpirationYear` for the `onSubmit` callback data.

## Props

<Props of={ReEnterCard} />
<ViewInheritance />
<FormSubmissionHandling />

## Resources

- [Form Component](?path=/docs/components-forms--form)
- [View Component](?path=/docs/components-view--view-screen)
- [React Hook Form](https://react-hook-form.com/)
